{# bouton pour enclencher la modale #}
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#drawModal">
  Créer un Tirage
</button>

{# modale #}
<div class="modal fade" id="drawModal" tabindex="-1" aria-labelledby="drawModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="drawModalLabel">Ajouter des participants</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="add-members">
                    <form class="form-inline" id="add-members-form" method="POST" action="{{path('draw_new')}}">
                        <label for="participant-select">Participants</label>
                        <select class="form-select" id="participant-select" style="width:100%;">
                            {% for user in users %}
                            <option>{{ user.username }}</option>
                            {% endfor %}
                        </select>
                        <div class="btn-add mt-2">
                            <button class="btn btn-primary" id="add" type="submit">Ajouter</button>
                        </div>
                    </form>
                    <ul id="members-list"></ul>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="save-list">Enregistrer la liste</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
            </div>
        </div>
    </div>
</div>







<script>

// on sélectionne l'élément avec son id
    document.addEventListener('DOMContentLoaded', () => {
    const drawModal = document.getElementById('drawModal');
    if (!drawModal) return;
    
    drawModal.addEventListener('show.bs.modal', (event) => {
        const button = event.relatedTarget;
        const recipient = button.getAttribute('data-bs-whatever');
    });

    // formulaire d'ajout de participants
    const form = document.querySelector('#add-members form');
    const select = document.getElementById('participant-select');
    const list  = document.getElementById('members-list');
    const output    = document.getElementById('members-output'); // ul sur la page
    const saveBtn   = document.getElementById('save-list');

    form.addEventListener('submit', (e) => {
        e.preventDefault();
        const value = (select.value || '').trim();
        if (!value) return;

        const li = document.createElement('li');
        li.textContent = value; 
        list.appendChild(li);

        form.reset();
        input.focus();
    });
    saveBtn.addEventListener('click', () => {
    // déplace tous les <li> de la modale vers la page
        output.replaceChildren(...list.querySelectorAll('li'));

        // ferme la modale
        bootstrap.Modal.getOrCreateInstance(drawModal).hide();
    });

    // cliquer sur un <li> pour le supprimer
    list.addEventListener('click', (e) => {
        if (e.target.tagName === 'LI') {
        e.target.remove();
        }
    });
    });
</script>
