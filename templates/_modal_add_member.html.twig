{# bouton pour enclencher la modale #}
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#drawModal">
  Créer un Tirage
</button>

{# modale #}
<div class="modal fade" id="drawModal" tabindex="-1" aria-labelledby="drawModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form class="form-inline" id="add-members-form" method="POST" action="{{ path('draw_new') }}">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="drawModalLabel">Ajouter des participants</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body">
                    <label for="participant-select">Participants</label>
                    <select class="form-select" id="participant-select" style="width:100%;">
                        {% for user in users %}
                            <option value="{{ user.id }}">{{ user.username }}</option>
                        {% endfor %}
                    </select>

                    <div class="btn-add mt-2">
                        <button class="btn btn-primary" id="add" type="button">+ Ajouter</button>
                    </div>

                    <ul id="members-list" class="mt-3"></ul>

                    <input type="hidden" name="participants" id="selected-participants">
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Enregistrer la liste</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                </div>
            </form>
        </div>
    </div>
</div>










<script>
    document.addEventListener("DOMContentLoaded", function () {
    const addBtn = document.getElementById("add");
    const select = document.getElementById("participant-select");
    const membersList = document.getElementById("members-list");
    const hiddenInput = document.getElementById("selected-participants");

    let selectedIds = [];

    addBtn.addEventListener("click", function () {
        const selectedOption = select.options[select.selectedIndex];
        const userId = selectedOption.value;
        const username = selectedOption.text;

        if (userId && !selectedIds.includes(userId)) {
            selectedIds.push(userId);

            // affichage dans la liste de la modale
            const li = document.createElement("li");
            li.textContent = username;
            membersList.appendChild(li);

            // mise à jour de l'input caché pour le POST
            hiddenInput.value = selectedIds.join(',');
        }
    });
});
</script>
